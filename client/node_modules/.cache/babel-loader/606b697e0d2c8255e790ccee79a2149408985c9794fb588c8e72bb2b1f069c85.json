{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\treev\\\\mindmap-app\\\\client\\\\src\\\\components\\\\MindmapCanvas.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useRef } from 'react';\nimport { marked } from 'marked';\nimport ThankButton from './ThankButton';\n\n/**\r\n * MindmapCanvas.js\r\n * \r\n * キャンバス上でノードを自由配置・編集するコンポーネント\r\n * \r\n * 追加機能:\r\n * - ノード追加ボタン\r\n * - エッジ追加モード：ノードをクリックして線を引く機能（既存）\r\n * - ゴミ箱アイコンによるドラッグ＆ドロップでの削除機能\r\n *   ・キャンバス下部中央に赤いゴミ箱アイコンを絶対配置（スクロール影響なし）\r\n *   ・ドラッグ中のノードは通常より大きく表示。ゴミ箱上に来ると元サイズに戻り、ゴミ箱が大きく表示される\r\n * - ノードはダブルクリックでMarkdown形式のテキスト編集モードに入り、  \r\n *   ・編集モードは <textarea> を使用し、Shift+Enter で改行、Enter（単独）で編集完了しMarkdownレンダリング\r\n * - ノードの右下（外側）に、薄いグレーのコピーアイコンを配置。  \r\n *   ・アイコンは下記の data URL の画像を利用し、クリックすると当該ノードのMarkdownテキストがクリップボードにコピーされる\r\n */\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction MindmapCanvas({\n  mindmap,\n  setMindmap\n}) {\n  _s();\n  const [dragging, setDragging] = useState({\n    isDragging: false,\n    nodeIndex: null,\n    offsetX: 0,\n    offsetY: 0\n  });\n  const [isEdgeMode, setIsEdgeMode] = useState(false);\n  const [edgeStart, setEdgeStart] = useState(null);\n  const [editingNodeId, setEditingNodeId] = useState(null);\n  const [editingText, setEditingText] = useState('');\n  const [trashHovered, setTrashHovered] = useState(false);\n  const trashRef = useRef(null);\n\n  // コピーアイコン用画像（data URL）\n  const copyIconDataUrl = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMwAAADACAMAAAB/Pny7AAAAYFBMVEX///8AAAAzMzOEhIR2dna9vb1RUVHb29tCQkL8/PzR0dFfX1/i4uL4+Pju7u719fVnZ2fKyspKSkqOjo6mpqYICAgWFhbo6OiWlpacnJwjIyNaWlosLCy1tbU9PT1+fn6/IQvoAAAE4ElEQVR4nO2d25KiMBBAuSoochNEEfT//3Kdh9kdu0MrSSdxtvq8aoUcQkInodJBoM85dM/FoL4kRw8yYVL9RzJhXVqRSb3IhIkVm6H3Y3O3YXPw85yF/cVGvyk2fmzGNLdgs/NkExUWZIIi9mMT22iaICjn2BrJcsPvrMhYJk+vyjGz910xTYpkVNikvqulS9pimcl3pbQZ9tim8V0pbcoEydS+66RPcUXP2eC7Tvo0NyBzmn1XSZ+8g02T+K6SAVv4oG3sRAFugLP0bOu7RgY0GRgBfu1780EFhueTtcUNF8AIPfZdIRPOIOT8zcNZME+cMuVQMDOsWZtIIyaZsumOcVLveanrJD7O2zdfGDwyVXrfZyf4BuZiautj844Ph8xw3kzqarDRR233evnIXKaKRydrfX3U2ZbB4Z1Fbi/mW4YyWxh3W+ZOzlGMZKrZrcqDlmocE5nSx1JyPy+PawYyA552O+GyaKMvMySeNiyWbbRlfLXLF0uhva5MdfTVLg9OC28cTZl89uiy+MLRlCm8uoRhrXzf6MlUirVdt5xVg4CezGXhEqdxiliZxoVY/KRarNCSqZTlj23SNcOBk7JILwtzC9WOspbMXXWr6s7OxwTB9rxR9VBF0+jIlIqi35luaFOcFfMlxYcYOjKKkKy2u4WYp4roHF9SQ6bCBcfWdw8Uc40jGtA0ZFLUIRMHOyEFkunRg60hg4KyjZMF6gbZoDBgvUyF9t7dbOrk6POIO/zLepkmgmVaHMd+ggdR+I/1MhfQZUZXu2147QQOzutlYJex9OGdgi2UgZ3GXOZop+YK0PY4nNaslinB5wOTuz1d9JzByq6WgfvtmcPPh+A3n1f4+1qZLRiZNw4/HWjA2NOC341lrgdLNVewA/FmBn43ltk73GzfgcqKzE9EhgmRoRAZJkSGQmSYEBkKkWFCZChEhgmRoRAZJkSGQmSYEBkKkWFCZChEhgmRoRAZJkSGQmSYEBkKkWFCZChEhgmRoRAZJkSGQmSYEBkKkWFCZChEhgmRoRAZJkSGQmSYEBkKkWFCZChEhgmRoRAZJkSGQmSYEBkKkWFCZChEhgmRoRAZJkSGQmSYEBkKkWFCZChEhgmRofhNMuhoOsgnywzPR+IunYT8j0+WAWevZS/PxPpomd1TXr3X6Wc+Wib4eZzb7XWBny0TXL7P3O3h4WcqPlwmaOrbOI5R+1a+pk+XCYJi7rrmvSPkPl9mBSLDhMhQiAwTIkMhMkyIDIXIMGFd5urouPYvdiCn+TtRPkkBZFqHWWvh4dMb0wJhVvHIYdZamCPOOAH4oX4usHeXtbaCGUnOxkXCI+BfLk6xUYBUxqoUNCuBtydzlroeZdMojItMYWIbV4kBSpRn3rxM1NiumgaOZeaD2YMaFqrKBcVPgVIdvVx9fYMOJdO5ODhOH46iLF3mcYtGWOrIcY9oDij7TLhnuYX4Hk3mIz7NgF0YBuYvcMKh8GQ3cUuzx5e8MeW9iHDR4a2z1nGGGD3YDzqmcH2nKPvRc+5WYs60VmaIzNguhnvNt9D+HjNyR+/Jv/DFt4PndJqsqdVy9wmbn4k4o45KlbjRHa+3XlcBsx05pY+Z5+o7j5lb1RloDcgbGD0748qfJipvHGeg/2ZjJdjYql7M1rEVOPnIeHw0iZr+ADeKbz+vhOlaAAAAAElFTkSuQmCC\";\n\n  // ドラッグ開始（エッジ追加モード、または編集中は無効）\n  const handleDragStart = (e, index) => {\n    if (isEdgeMode) return;\n    if (editingNodeId) return;\n    const rect = e.target.getBoundingClientRect();\n    const offsetX = e.clientX - rect.left;\n    const offsetY = e.clientY - rect.top;\n    setDragging({\n      isDragging: true,\n      nodeIndex: index,\n      offsetX,\n      offsetY\n    });\n  };\n\n  // ドラッグ中\n  const handleMouseMove = e => {\n    if (!dragging.isDragging) return;\n    const containerRect = e.currentTarget.getBoundingClientRect();\n    const newX = e.clientX - containerRect.left - dragging.offsetX;\n    const newY = e.clientY - containerRect.top - dragging.offsetY;\n    const newNodes = [...mindmap.nodes];\n    newNodes[dragging.nodeIndex] = {\n      ...newNodes[dragging.nodeIndex],\n      x: newX,\n      y: newY\n    };\n    setMindmap({\n      ...mindmap,\n      nodes: newNodes\n    });\n\n    // ゴミ箱との重なり判定\n    if (trashRef.current) {\n      const trashRect = trashRef.current.getBoundingClientRect();\n      const nodeCenterX = newX + 50;\n      const nodeCenterY = newY + 20;\n      if (nodeCenterX >= trashRect.left && nodeCenterX <= trashRect.right && nodeCenterY >= trashRect.top && nodeCenterY <= trashRect.bottom) {\n        setTrashHovered(true);\n      } else {\n        setTrashHovered(false);\n      }\n    }\n  };\n\n  // ドラッグ終了：ゴミ箱上なら対象ノードを削除\n  const handleMouseUp = () => {\n    if (dragging.isDragging) {\n      if (trashHovered) {\n        const newNodes = mindmap.nodes.filter((_, idx) => idx !== dragging.nodeIndex);\n        setMindmap({\n          ...mindmap,\n          nodes: newNodes\n        });\n      }\n      setDragging({\n        isDragging: false,\n        nodeIndex: null,\n        offsetX: 0,\n        offsetY: 0\n      });\n      setTrashHovered(false);\n    }\n  };\n\n  // ノード追加\n  const addNode = () => {\n    const newNodeId = `node_${Date.now()}`;\n    const newNode = {\n      nodeId: newNodeId,\n      text: '新しいノード',\n      x: 100 + Math.random() * 200,\n      y: 100 + Math.random() * 200\n    };\n    setMindmap({\n      ...mindmap,\n      nodes: [...mindmap.nodes, newNode]\n    });\n  };\n\n  // エッジ追加モード時のノードクリック処理\n  const handleNodeClick = (node, index) => {\n    if (isEdgeMode) {\n      if (!edgeStart) {\n        setEdgeStart(node.nodeId);\n      } else {\n        if (edgeStart === node.nodeId) {\n          setEdgeStart(null);\n        } else {\n          const newEdge = {\n            id: `edge_${Date.now()}`,\n            from: edgeStart,\n            to: node.nodeId\n          };\n          const newEdges = mindmap.edges ? [...mindmap.edges, newEdge] : [newEdge];\n          setMindmap({\n            ...mindmap,\n            edges: newEdges\n          });\n          setEdgeStart(null);\n        }\n      }\n    }\n  };\n\n  // エッジ削除（クリック時に確認）\n  const handleEdgeClick = (edgeId, e) => {\n    e.stopPropagation();\n    if (window.confirm('この線を削除しますか？')) {\n      const newEdges = (mindmap.edges || []).filter(edge => edge.id !== edgeId);\n      setMindmap({\n        ...mindmap,\n        edges: newEdges\n      });\n    }\n  };\n\n  // ノードIDからノード情報を取得\n  const getNodeById = nodeId => {\n    return mindmap.nodes.find(n => n.nodeId === nodeId);\n  };\n\n  // ノードをダブルクリックでMarkdown編集モードに切替\n  const handleNodeDoubleClick = node => {\n    if (isEdgeMode) return;\n    setEditingNodeId(node.nodeId);\n    setEditingText(node.text);\n  };\n\n  // 編集完了：Enter（単独）で完了。Shift+Enter で改行\n  const handleEditFinish = nodeId => {\n    const newNodes = mindmap.nodes.map(node => {\n      if (node.nodeId === nodeId) {\n        return {\n          ...node,\n          text: editingText\n        };\n      }\n      return node;\n    });\n    setMindmap({\n      ...mindmap,\n      nodes: newNodes\n    });\n    setEditingNodeId(null);\n    setEditingText('');\n  };\n\n  // テキストエリア内で、Enterキー（Shiftキーなし）で編集完了、Shift+Enter で改行\n  const handleKeyDown = (e, nodeId) => {\n    if (e.key === 'Enter' && !e.shiftKey) {\n      e.preventDefault();\n      handleEditFinish(nodeId);\n    }\n  };\n\n  // Markdownテキストをクリップボードにコピーする\n  const copyMarkdown = (text, e) => {\n    e.stopPropagation();\n    navigator.clipboard.writeText(text).then(() => {\n      alert(\"Markdown copied to clipboard!\");\n    }).catch(err => {\n      console.error(\"コピーに失敗しました: \", err);\n    });\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        marginBottom: 10\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: addNode,\n        children: \"\\u30CE\\u30FC\\u30C9\\u8FFD\\u52A0\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 181,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => {\n          setIsEdgeMode(!isEdgeMode);\n          setEdgeStart(null);\n        },\n        style: {\n          marginLeft: 10\n        },\n        children: isEdgeMode ? 'エッジ追加モード解除' : 'エッジ追加モード'\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 182,\n        columnNumber: 9\n      }, this), isEdgeMode && /*#__PURE__*/_jsxDEV(\"span\", {\n        style: {\n          marginLeft: 10,\n          color: 'blue'\n        },\n        children: edgeStart ? `開始ノード: ${edgeStart} - 終了ノードを選択` : 'ノードを選択してエッジ開始'\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 192,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 180,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        position: 'relative',\n        width: '100%',\n        height: '500px',\n        border: '1px solid #777',\n        overflow: 'hidden'\n      },\n      onMouseMove: handleMouseMove,\n      onMouseUp: handleMouseUp,\n      children: [/*#__PURE__*/_jsxDEV(\"svg\", {\n        style: {\n          position: 'absolute',\n          top: 0,\n          left: 0,\n          width: '100%',\n          height: '100%',\n          pointerEvents: 'none'\n        },\n        children: (mindmap.edges || []).map(edge => {\n          const fromNode = getNodeById(edge.from);\n          const toNode = getNodeById(edge.to);\n          if (!fromNode || !toNode) return null;\n          return /*#__PURE__*/_jsxDEV(\"line\", {\n            x1: fromNode.x + 50,\n            y1: fromNode.y + 20,\n            x2: toNode.x + 50,\n            y2: toNode.y + 20,\n            stroke: \"black\",\n            strokeWidth: \"2\",\n            pointerEvents: \"visibleStroke\",\n            onClick: e => handleEdgeClick(edge.id, e)\n          }, edge.id, false, {\n            fileName: _jsxFileName,\n            lineNumber: 226,\n            columnNumber: 15\n          }, this);\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 211,\n        columnNumber: 9\n      }, this), mindmap.nodes.map((node, idx) => {\n        const isDraggingNode = dragging.isDragging && dragging.nodeIndex === idx;\n        const scale = isDraggingNode ? trashHovered ? 1.0 : 1.1 : 1.0;\n        return /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            position: 'absolute',\n            left: node.x,\n            top: node.y,\n            padding: '8px 12px',\n            background: idx === 0 ? '#ffe4b2' : '#d1f0d1',\n            border: '1px solid #333',\n            borderRadius: '4px',\n            cursor: isEdgeMode ? 'pointer' : 'move',\n            userSelect: 'none',\n            transform: `scale(${scale})`,\n            transformOrigin: 'center'\n          },\n          onMouseDown: e => handleDragStart(e, idx),\n          onClick: () => handleNodeClick(node, idx),\n          onDoubleClick: () => handleNodeDoubleClick(node),\n          children: editingNodeId === node.nodeId ? /*#__PURE__*/_jsxDEV(\"textarea\", {\n            value: editingText,\n            onChange: e => setEditingText(e.target.value),\n            onKeyDown: e => handleKeyDown(e, node.nodeId),\n            autoFocus: true,\n            style: {\n              width: '200px',\n              height: '100px'\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 265,\n            columnNumber: 17\n          }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              position: 'relative'\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              dangerouslySetInnerHTML: {\n                __html: marked.parse(node.text)\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 274,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              onClick: e => copyMarkdown(node.text, e),\n              style: {\n                position: 'absolute',\n                bottom: -10,\n                right: -10,\n                width: '24px',\n                height: '24px',\n                backgroundImage: `url(${copyIconDataUrl})`,\n                backgroundSize: 'cover',\n                opacity: 0.7,\n                cursor: 'pointer'\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 276,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 273,\n            columnNumber: 17\n          }, this)\n        }, node.nodeId, false, {\n          fileName: _jsxFileName,\n          lineNumber: 245,\n          columnNumber: 13\n        }, this);\n      }), /*#__PURE__*/_jsxDEV(\"div\", {\n        ref: trashRef,\n        style: {\n          position: 'absolute',\n          bottom: 20,\n          left: '50%',\n          transform: 'translateX(-50%)',\n          pointerEvents: 'none'\n        },\n        children: /*#__PURE__*/_jsxDEV(\"svg\", {\n          width: trashHovered ? 50 : 30,\n          height: trashHovered ? 50 : 30,\n          viewBox: \"0 0 24 24\",\n          fill: \"red\",\n          children: /*#__PURE__*/_jsxDEV(\"path\", {\n            d: \"M3 6h18v2H3zm2 3h14l-1.5 12.5a2 2 0 01-2 1.5H8.5a2 2 0 01-2-1.5L5 9zm5 2v9h2v-9H10zm4 0v9h2v-9h-2zM9 4V2h6v2h5v2H4V4z\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 312,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 306,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 296,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          position: 'absolute',\n          bottom: 10,\n          left: 10\n        },\n        children: /*#__PURE__*/_jsxDEV(ThankButton, {\n          mindmapId: mindmap.id\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 317,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 316,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 199,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 178,\n    columnNumber: 5\n  }, this);\n}\n_s(MindmapCanvas, \"YW/LexaB/JKdciZXor24Wcsa0RU=\");\n_c = MindmapCanvas;\nexport default MindmapCanvas;\nvar _c;\n$RefreshReg$(_c, \"MindmapCanvas\");","map":{"version":3,"names":["React","useState","useRef","marked","ThankButton","jsxDEV","_jsxDEV","MindmapCanvas","mindmap","setMindmap","_s","dragging","setDragging","isDragging","nodeIndex","offsetX","offsetY","isEdgeMode","setIsEdgeMode","edgeStart","setEdgeStart","editingNodeId","setEditingNodeId","editingText","setEditingText","trashHovered","setTrashHovered","trashRef","copyIconDataUrl","handleDragStart","e","index","rect","target","getBoundingClientRect","clientX","left","clientY","top","handleMouseMove","containerRect","currentTarget","newX","newY","newNodes","nodes","x","y","current","trashRect","nodeCenterX","nodeCenterY","right","bottom","handleMouseUp","filter","_","idx","addNode","newNodeId","Date","now","newNode","nodeId","text","Math","random","handleNodeClick","node","newEdge","id","from","to","newEdges","edges","handleEdgeClick","edgeId","stopPropagation","window","confirm","edge","getNodeById","find","n","handleNodeDoubleClick","handleEditFinish","map","handleKeyDown","key","shiftKey","preventDefault","copyMarkdown","navigator","clipboard","writeText","then","alert","catch","err","console","error","children","style","marginBottom","onClick","fileName","_jsxFileName","lineNumber","columnNumber","marginLeft","color","position","width","height","border","overflow","onMouseMove","onMouseUp","pointerEvents","fromNode","toNode","x1","y1","x2","y2","stroke","strokeWidth","isDraggingNode","scale","padding","background","borderRadius","cursor","userSelect","transform","transformOrigin","onMouseDown","onDoubleClick","value","onChange","onKeyDown","autoFocus","dangerouslySetInnerHTML","__html","parse","backgroundImage","backgroundSize","opacity","ref","viewBox","fill","d","mindmapId","_c","$RefreshReg$"],"sources":["C:/Users/treev/mindmap-app/client/src/components/MindmapCanvas.js"],"sourcesContent":["import React, { useState, useRef } from 'react';\r\nimport { marked } from 'marked';\r\nimport ThankButton from './ThankButton';\r\n\r\n/**\r\n * MindmapCanvas.js\r\n * \r\n * キャンバス上でノードを自由配置・編集するコンポーネント\r\n * \r\n * 追加機能:\r\n * - ノード追加ボタン\r\n * - エッジ追加モード：ノードをクリックして線を引く機能（既存）\r\n * - ゴミ箱アイコンによるドラッグ＆ドロップでの削除機能\r\n *   ・キャンバス下部中央に赤いゴミ箱アイコンを絶対配置（スクロール影響なし）\r\n *   ・ドラッグ中のノードは通常より大きく表示。ゴミ箱上に来ると元サイズに戻り、ゴミ箱が大きく表示される\r\n * - ノードはダブルクリックでMarkdown形式のテキスト編集モードに入り、  \r\n *   ・編集モードは <textarea> を使用し、Shift+Enter で改行、Enter（単独）で編集完了しMarkdownレンダリング\r\n * - ノードの右下（外側）に、薄いグレーのコピーアイコンを配置。  \r\n *   ・アイコンは下記の data URL の画像を利用し、クリックすると当該ノードのMarkdownテキストがクリップボードにコピーされる\r\n */\r\nfunction MindmapCanvas({ mindmap, setMindmap }) {\r\n  const [dragging, setDragging] = useState({\r\n    isDragging: false,\r\n    nodeIndex: null,\r\n    offsetX: 0,\r\n    offsetY: 0,\r\n  });\r\n  const [isEdgeMode, setIsEdgeMode] = useState(false);\r\n  const [edgeStart, setEdgeStart] = useState(null);\r\n  const [editingNodeId, setEditingNodeId] = useState(null);\r\n  const [editingText, setEditingText] = useState('');\r\n  const [trashHovered, setTrashHovered] = useState(false);\r\n  const trashRef = useRef(null);\r\n\r\n  // コピーアイコン用画像（data URL）\r\n  const copyIconDataUrl = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMwAAADACAMAAAB/Pny7AAAAYFBMVEX///8AAAAzMzOEhIR2dna9vb1RUVHb29tCQkL8/PzR0dFfX1/i4uL4+Pju7u719fVnZ2fKyspKSkqOjo6mpqYICAgWFhbo6OiWlpacnJwjIyNaWlosLCy1tbU9PT1+fn6/IQvoAAAE4ElEQVR4nO2d25KiMBBAuSoochNEEfT//3Kdh9kdu0MrSSdxtvq8aoUcQkInodJBoM85dM/FoL4kRw8yYVL9RzJhXVqRSb3IhIkVm6H3Y3O3YXPw85yF/cVGvyk2fmzGNLdgs/NkExUWZIIi9mMT22iaICjn2BrJcsPvrMhYJk+vyjGz910xTYpkVNikvqulS9pimcl3pbQZ9tim8V0pbcoEydS+66RPcUXP2eC7Tvo0NyBzmn1XSZ+8g02T+K6SAVv4oG3sRAFugLP0bOu7RgY0GRgBfu1780EFhueTtcUNF8AIPfZdIRPOIOT8zcNZME+cMuVQMDOsWZtIIyaZsumOcVLveanrJD7O2zdfGDwyVXrfZyf4BuZiautj844Ph8xw3kzqarDRR233evnIXKaKRydrfX3U2ZbB4Z1Fbi/mW4YyWxh3W+ZOzlGMZKrZrcqDlmocE5nSx1JyPy+PawYyA552O+GyaKMvMySeNiyWbbRlfLXLF0uhva5MdfTVLg9OC28cTZl89uiy+MLRlCm8uoRhrXzf6MlUirVdt5xVg4CezGXhEqdxiliZxoVY/KRarNCSqZTlj23SNcOBk7JILwtzC9WOspbMXXWr6s7OxwTB9rxR9VBF0+jIlIqi35luaFOcFfMlxYcYOjKKkKy2u4WYp4roHF9SQ6bCBcfWdw8Uc40jGtA0ZFLUIRMHOyEFkunRg60hg4KyjZMF6gbZoDBgvUyF9t7dbOrk6POIO/zLepkmgmVaHMd+ggdR+I/1MhfQZUZXu2147QQOzutlYJex9OGdgi2UgZ3GXOZop+YK0PY4nNaslinB5wOTuz1d9JzByq6WgfvtmcPPh+A3n1f4+1qZLRiZNw4/HWjA2NOC341lrgdLNVewA/FmBn43ltk73GzfgcqKzE9EhgmRoRAZJkSGQmSYEBkKkWFCZChEhgmRoRAZJkSGQmSYEBkKkWFCZChEhgmRoRAZJkSGQmSYEBkKkWFCZChEhgmRoRAZJkSGQmSYEBkKkWFCZChEhgmRoRAZJkSGQmSYEBkKkWFCZChEhgmRoRAZJkSGQmSYEBkKkWFCZChEhgmRoRAZJkSGQmSYEBkKkWFCZChEhgmRofhNMuhoOsgnywzPR+IunYT8j0+WAWevZS/PxPpomd1TXr3X6Wc+Wib4eZzb7XWBny0TXL7P3O3h4WcqPlwmaOrbOI5R+1a+pk+XCYJi7rrmvSPkPl9mBSLDhMhQiAwTIkMhMkyIDIXIMGFd5urouPYvdiCn+TtRPkkBZFqHWWvh4dMb0wJhVvHIYdZamCPOOAH4oX4usHeXtbaCGUnOxkXCI+BfLk6xUYBUxqoUNCuBtydzlroeZdMojItMYWIbV4kBSpRn3rxM1NiumgaOZeaD2YMaFqrKBcVPgVIdvVx9fYMOJdO5ODhOH46iLF3mcYtGWOrIcY9oDij7TLhnuYX4Hk3mIz7NgF0YBuYvcMKh8GQ3cUuzx5e8MeW9iHDR4a2z1nGGGD3YDzqmcH2nKPvRc+5WYs60VmaIzNguhnvNt9D+HjNyR+/Jv/DFt4PndJqsqdVy9wmbn4k4o45KlbjRHa+3XlcBsx05pY+Z5+o7j5lb1RloDcgbGD0748qfJipvHGeg/2ZjJdjYql7M1rEVOPnIeHw0iZr+ADeKbz+vhOlaAAAAAElFTkSuQmCC\";\r\n\r\n  // ドラッグ開始（エッジ追加モード、または編集中は無効）\r\n  const handleDragStart = (e, index) => {\r\n    if (isEdgeMode) return;\r\n    if (editingNodeId) return;\r\n    const rect = e.target.getBoundingClientRect();\r\n    const offsetX = e.clientX - rect.left;\r\n    const offsetY = e.clientY - rect.top;\r\n    setDragging({ isDragging: true, nodeIndex: index, offsetX, offsetY });\r\n  };\r\n\r\n  // ドラッグ中\r\n  const handleMouseMove = (e) => {\r\n    if (!dragging.isDragging) return;\r\n    const containerRect = e.currentTarget.getBoundingClientRect();\r\n    const newX = e.clientX - containerRect.left - dragging.offsetX;\r\n    const newY = e.clientY - containerRect.top - dragging.offsetY;\r\n    const newNodes = [...mindmap.nodes];\r\n    newNodes[dragging.nodeIndex] = { ...newNodes[dragging.nodeIndex], x: newX, y: newY };\r\n    setMindmap({ ...mindmap, nodes: newNodes });\r\n\r\n    // ゴミ箱との重なり判定\r\n    if (trashRef.current) {\r\n      const trashRect = trashRef.current.getBoundingClientRect();\r\n      const nodeCenterX = newX + 50;\r\n      const nodeCenterY = newY + 20;\r\n      if (\r\n        nodeCenterX >= trashRect.left &&\r\n        nodeCenterX <= trashRect.right &&\r\n        nodeCenterY >= trashRect.top &&\r\n        nodeCenterY <= trashRect.bottom\r\n      ) {\r\n        setTrashHovered(true);\r\n      } else {\r\n        setTrashHovered(false);\r\n      }\r\n    }\r\n  };\r\n\r\n  // ドラッグ終了：ゴミ箱上なら対象ノードを削除\r\n  const handleMouseUp = () => {\r\n    if (dragging.isDragging) {\r\n      if (trashHovered) {\r\n        const newNodes = mindmap.nodes.filter((_, idx) => idx !== dragging.nodeIndex);\r\n        setMindmap({ ...mindmap, nodes: newNodes });\r\n      }\r\n      setDragging({ isDragging: false, nodeIndex: null, offsetX: 0, offsetY: 0 });\r\n      setTrashHovered(false);\r\n    }\r\n  };\r\n\r\n  // ノード追加\r\n  const addNode = () => {\r\n    const newNodeId = `node_${Date.now()}`;\r\n    const newNode = {\r\n      nodeId: newNodeId,\r\n      text: '新しいノード',\r\n      x: 100 + Math.random() * 200,\r\n      y: 100 + Math.random() * 200,\r\n    };\r\n    setMindmap({\r\n      ...mindmap,\r\n      nodes: [...mindmap.nodes, newNode],\r\n    });\r\n  };\r\n\r\n  // エッジ追加モード時のノードクリック処理\r\n  const handleNodeClick = (node, index) => {\r\n    if (isEdgeMode) {\r\n      if (!edgeStart) {\r\n        setEdgeStart(node.nodeId);\r\n      } else {\r\n        if (edgeStart === node.nodeId) {\r\n          setEdgeStart(null);\r\n        } else {\r\n          const newEdge = {\r\n            id: `edge_${Date.now()}`,\r\n            from: edgeStart,\r\n            to: node.nodeId,\r\n          };\r\n          const newEdges = mindmap.edges ? [...mindmap.edges, newEdge] : [newEdge];\r\n          setMindmap({ ...mindmap, edges: newEdges });\r\n          setEdgeStart(null);\r\n        }\r\n      }\r\n    }\r\n  };\r\n\r\n  // エッジ削除（クリック時に確認）\r\n  const handleEdgeClick = (edgeId, e) => {\r\n    e.stopPropagation();\r\n    if (window.confirm('この線を削除しますか？')) {\r\n      const newEdges = (mindmap.edges || []).filter(edge => edge.id !== edgeId);\r\n      setMindmap({ ...mindmap, edges: newEdges });\r\n    }\r\n  };\r\n\r\n  // ノードIDからノード情報を取得\r\n  const getNodeById = (nodeId) => {\r\n    return mindmap.nodes.find(n => n.nodeId === nodeId);\r\n  };\r\n\r\n  // ノードをダブルクリックでMarkdown編集モードに切替\r\n  const handleNodeDoubleClick = (node) => {\r\n    if (isEdgeMode) return;\r\n    setEditingNodeId(node.nodeId);\r\n    setEditingText(node.text);\r\n  };\r\n\r\n  // 編集完了：Enter（単独）で完了。Shift+Enter で改行\r\n  const handleEditFinish = (nodeId) => {\r\n    const newNodes = mindmap.nodes.map(node => {\r\n      if (node.nodeId === nodeId) {\r\n        return { ...node, text: editingText };\r\n      }\r\n      return node;\r\n    });\r\n    setMindmap({ ...mindmap, nodes: newNodes });\r\n    setEditingNodeId(null);\r\n    setEditingText('');\r\n  };\r\n\r\n  // テキストエリア内で、Enterキー（Shiftキーなし）で編集完了、Shift+Enter で改行\r\n  const handleKeyDown = (e, nodeId) => {\r\n    if (e.key === 'Enter' && !e.shiftKey) {\r\n      e.preventDefault();\r\n      handleEditFinish(nodeId);\r\n    }\r\n  };\r\n\r\n  // Markdownテキストをクリップボードにコピーする\r\n  const copyMarkdown = (text, e) => {\r\n    e.stopPropagation();\r\n    navigator.clipboard.writeText(text).then(() => {\r\n      alert(\"Markdown copied to clipboard!\");\r\n    }).catch((err) => {\r\n      console.error(\"コピーに失敗しました: \", err);\r\n    });\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      {/* 操作用ボタン群 */}\r\n      <div style={{ marginBottom: 10 }}>\r\n        <button onClick={addNode}>ノード追加</button>\r\n        <button \r\n          onClick={() => {\r\n            setIsEdgeMode(!isEdgeMode);\r\n            setEdgeStart(null);\r\n          }}\r\n          style={{ marginLeft: 10 }}\r\n        >\r\n          {isEdgeMode ? 'エッジ追加モード解除' : 'エッジ追加モード'}\r\n        </button>\r\n        {isEdgeMode && (\r\n          <span style={{ marginLeft: 10, color: 'blue' }}>\r\n            {edgeStart ? `開始ノード: ${edgeStart} - 終了ノードを選択` : 'ノードを選択してエッジ開始'}\r\n          </span>\r\n        )}\r\n      </div>\r\n      \r\n      {/* キャンバス領域 */}\r\n      <div \r\n        style={{ \r\n          position: 'relative', \r\n          width: '100%', \r\n          height: '500px', \r\n          border: '1px solid #777',\r\n          overflow: 'hidden'\r\n        }}\r\n        onMouseMove={handleMouseMove}\r\n        onMouseUp={handleMouseUp}\r\n      >\r\n        {/* SVGレイヤー：ノード間の線を描画 */}\r\n        <svg \r\n          style={{\r\n            position: 'absolute',\r\n            top: 0,\r\n            left: 0,\r\n            width: '100%',\r\n            height: '100%',\r\n            pointerEvents: 'none'\r\n          }}\r\n        >\r\n          {(mindmap.edges || []).map((edge) => {\r\n            const fromNode = getNodeById(edge.from);\r\n            const toNode = getNodeById(edge.to);\r\n            if (!fromNode || !toNode) return null;\r\n            return (\r\n              <line\r\n                key={edge.id}\r\n                x1={fromNode.x + 50}\r\n                y1={fromNode.y + 20}\r\n                x2={toNode.x + 50}\r\n                y2={toNode.y + 20}\r\n                stroke=\"black\"\r\n                strokeWidth=\"2\"\r\n                pointerEvents=\"visibleStroke\"\r\n                onClick={(e) => handleEdgeClick(edge.id, e)}\r\n              />\r\n            );\r\n          })}\r\n        </svg>\r\n        {/* ノード描画 */}\r\n        {mindmap.nodes.map((node, idx) => {\r\n          const isDraggingNode = dragging.isDragging && dragging.nodeIndex === idx;\r\n          const scale = isDraggingNode ? (trashHovered ? 1.0 : 1.1) : 1.0;\r\n          return (\r\n            <div\r\n              key={node.nodeId}\r\n              style={{\r\n                position: 'absolute',\r\n                left: node.x,\r\n                top: node.y,\r\n                padding: '8px 12px',\r\n                background: idx === 0 ? '#ffe4b2' : '#d1f0d1',\r\n                border: '1px solid #333',\r\n                borderRadius: '4px',\r\n                cursor: isEdgeMode ? 'pointer' : 'move',\r\n                userSelect: 'none',\r\n                transform: `scale(${scale})`,\r\n                transformOrigin: 'center',\r\n              }}\r\n              onMouseDown={(e) => handleDragStart(e, idx)}\r\n              onClick={() => handleNodeClick(node, idx)}\r\n              onDoubleClick={() => handleNodeDoubleClick(node)}\r\n            >\r\n              {editingNodeId === node.nodeId ? (\r\n                <textarea\r\n                  value={editingText}\r\n                  onChange={(e) => setEditingText(e.target.value)}\r\n                  onKeyDown={(e) => handleKeyDown(e, node.nodeId)}\r\n                  autoFocus\r\n                  style={{ width: '200px', height: '100px' }}\r\n                />\r\n              ) : (\r\n                <div style={{ position: 'relative' }}>\r\n                  <div dangerouslySetInnerHTML={{ __html: marked.parse(node.text) }} />\r\n                  {/* コピーアイコン：右下のノード外側に配置 */}\r\n                  <div \r\n                    onClick={(e) => copyMarkdown(node.text, e)}\r\n                    style={{\r\n                      position: 'absolute',\r\n                      bottom: -10,\r\n                      right: -10,\r\n                      width: '24px',\r\n                      height: '24px',\r\n                      backgroundImage: `url(${copyIconDataUrl})`,\r\n                      backgroundSize: 'cover',\r\n                      opacity: 0.7,\r\n                      cursor: 'pointer',\r\n                    }}\r\n                  ></div>\r\n                </div>\r\n              )}\r\n            </div>\r\n          );\r\n        })}\r\n        {/* ゴミ箱アイコン：キャンバス下部中央に固定 */}\r\n        <div \r\n          ref={trashRef}\r\n          style={{\r\n            position: 'absolute',\r\n            bottom: 20,\r\n            left: '50%',\r\n            transform: 'translateX(-50%)',\r\n            pointerEvents: 'none'\r\n          }}\r\n        >\r\n          <svg \r\n            width={trashHovered ? 50 : 30}\r\n            height={trashHovered ? 50 : 30}\r\n            viewBox=\"0 0 24 24\"\r\n            fill=\"red\"\r\n          >\r\n            <path d=\"M3 6h18v2H3zm2 3h14l-1.5 12.5a2 2 0 01-2 1.5H8.5a2 2 0 01-2-1.5L5 9zm5 2v9h2v-9H10zm4 0v9h2v-9h-2zM9 4V2h6v2h5v2H4V4z\"/>\r\n          </svg>\r\n        </div>\r\n        {/* キャンバス下部に「ありがとう」ボタン */}\r\n        <div style={{ position: 'absolute', bottom: 10, left: 10 }}>\r\n          <ThankButton mindmapId={mindmap.id} />\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default MindmapCanvas;\r\n"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,QAAQ,EAAEC,MAAM,QAAQ,OAAO;AAC/C,SAASC,MAAM,QAAQ,QAAQ;AAC/B,OAAOC,WAAW,MAAM,eAAe;;AAEvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAfA,SAAAC,MAAA,IAAAC,OAAA;AAgBA,SAASC,aAAaA,CAAC;EAAEC,OAAO;EAAEC;AAAW,CAAC,EAAE;EAAAC,EAAA;EAC9C,MAAM,CAACC,QAAQ,EAAEC,WAAW,CAAC,GAAGX,QAAQ,CAAC;IACvCY,UAAU,EAAE,KAAK;IACjBC,SAAS,EAAE,IAAI;IACfC,OAAO,EAAE,CAAC;IACVC,OAAO,EAAE;EACX,CAAC,CAAC;EACF,MAAM,CAACC,UAAU,EAAEC,aAAa,CAAC,GAAGjB,QAAQ,CAAC,KAAK,CAAC;EACnD,MAAM,CAACkB,SAAS,EAAEC,YAAY,CAAC,GAAGnB,QAAQ,CAAC,IAAI,CAAC;EAChD,MAAM,CAACoB,aAAa,EAAEC,gBAAgB,CAAC,GAAGrB,QAAQ,CAAC,IAAI,CAAC;EACxD,MAAM,CAACsB,WAAW,EAAEC,cAAc,CAAC,GAAGvB,QAAQ,CAAC,EAAE,CAAC;EAClD,MAAM,CAACwB,YAAY,EAAEC,eAAe,CAAC,GAAGzB,QAAQ,CAAC,KAAK,CAAC;EACvD,MAAM0B,QAAQ,GAAGzB,MAAM,CAAC,IAAI,CAAC;;EAE7B;EACA,MAAM0B,eAAe,GAAG,o3DAAo3D;;EAE54D;EACA,MAAMC,eAAe,GAAGA,CAACC,CAAC,EAAEC,KAAK,KAAK;IACpC,IAAId,UAAU,EAAE;IAChB,IAAII,aAAa,EAAE;IACnB,MAAMW,IAAI,GAAGF,CAAC,CAACG,MAAM,CAACC,qBAAqB,CAAC,CAAC;IAC7C,MAAMnB,OAAO,GAAGe,CAAC,CAACK,OAAO,GAAGH,IAAI,CAACI,IAAI;IACrC,MAAMpB,OAAO,GAAGc,CAAC,CAACO,OAAO,GAAGL,IAAI,CAACM,GAAG;IACpC1B,WAAW,CAAC;MAAEC,UAAU,EAAE,IAAI;MAAEC,SAAS,EAAEiB,KAAK;MAAEhB,OAAO;MAAEC;IAAQ,CAAC,CAAC;EACvE,CAAC;;EAED;EACA,MAAMuB,eAAe,GAAIT,CAAC,IAAK;IAC7B,IAAI,CAACnB,QAAQ,CAACE,UAAU,EAAE;IAC1B,MAAM2B,aAAa,GAAGV,CAAC,CAACW,aAAa,CAACP,qBAAqB,CAAC,CAAC;IAC7D,MAAMQ,IAAI,GAAGZ,CAAC,CAACK,OAAO,GAAGK,aAAa,CAACJ,IAAI,GAAGzB,QAAQ,CAACI,OAAO;IAC9D,MAAM4B,IAAI,GAAGb,CAAC,CAACO,OAAO,GAAGG,aAAa,CAACF,GAAG,GAAG3B,QAAQ,CAACK,OAAO;IAC7D,MAAM4B,QAAQ,GAAG,CAAC,GAAGpC,OAAO,CAACqC,KAAK,CAAC;IACnCD,QAAQ,CAACjC,QAAQ,CAACG,SAAS,CAAC,GAAG;MAAE,GAAG8B,QAAQ,CAACjC,QAAQ,CAACG,SAAS,CAAC;MAAEgC,CAAC,EAAEJ,IAAI;MAAEK,CAAC,EAAEJ;IAAK,CAAC;IACpFlC,UAAU,CAAC;MAAE,GAAGD,OAAO;MAAEqC,KAAK,EAAED;IAAS,CAAC,CAAC;;IAE3C;IACA,IAAIjB,QAAQ,CAACqB,OAAO,EAAE;MACpB,MAAMC,SAAS,GAAGtB,QAAQ,CAACqB,OAAO,CAACd,qBAAqB,CAAC,CAAC;MAC1D,MAAMgB,WAAW,GAAGR,IAAI,GAAG,EAAE;MAC7B,MAAMS,WAAW,GAAGR,IAAI,GAAG,EAAE;MAC7B,IACEO,WAAW,IAAID,SAAS,CAACb,IAAI,IAC7Bc,WAAW,IAAID,SAAS,CAACG,KAAK,IAC9BD,WAAW,IAAIF,SAAS,CAACX,GAAG,IAC5Ba,WAAW,IAAIF,SAAS,CAACI,MAAM,EAC/B;QACA3B,eAAe,CAAC,IAAI,CAAC;MACvB,CAAC,MAAM;QACLA,eAAe,CAAC,KAAK,CAAC;MACxB;IACF;EACF,CAAC;;EAED;EACA,MAAM4B,aAAa,GAAGA,CAAA,KAAM;IAC1B,IAAI3C,QAAQ,CAACE,UAAU,EAAE;MACvB,IAAIY,YAAY,EAAE;QAChB,MAAMmB,QAAQ,GAAGpC,OAAO,CAACqC,KAAK,CAACU,MAAM,CAAC,CAACC,CAAC,EAAEC,GAAG,KAAKA,GAAG,KAAK9C,QAAQ,CAACG,SAAS,CAAC;QAC7EL,UAAU,CAAC;UAAE,GAAGD,OAAO;UAAEqC,KAAK,EAAED;QAAS,CAAC,CAAC;MAC7C;MACAhC,WAAW,CAAC;QAAEC,UAAU,EAAE,KAAK;QAAEC,SAAS,EAAE,IAAI;QAAEC,OAAO,EAAE,CAAC;QAAEC,OAAO,EAAE;MAAE,CAAC,CAAC;MAC3EU,eAAe,CAAC,KAAK,CAAC;IACxB;EACF,CAAC;;EAED;EACA,MAAMgC,OAAO,GAAGA,CAAA,KAAM;IACpB,MAAMC,SAAS,GAAG,QAAQC,IAAI,CAACC,GAAG,CAAC,CAAC,EAAE;IACtC,MAAMC,OAAO,GAAG;MACdC,MAAM,EAAEJ,SAAS;MACjBK,IAAI,EAAE,QAAQ;MACdlB,CAAC,EAAE,GAAG,GAAGmB,IAAI,CAACC,MAAM,CAAC,CAAC,GAAG,GAAG;MAC5BnB,CAAC,EAAE,GAAG,GAAGkB,IAAI,CAACC,MAAM,CAAC,CAAC,GAAG;IAC3B,CAAC;IACDzD,UAAU,CAAC;MACT,GAAGD,OAAO;MACVqC,KAAK,EAAE,CAAC,GAAGrC,OAAO,CAACqC,KAAK,EAAEiB,OAAO;IACnC,CAAC,CAAC;EACJ,CAAC;;EAED;EACA,MAAMK,eAAe,GAAGA,CAACC,IAAI,EAAErC,KAAK,KAAK;IACvC,IAAId,UAAU,EAAE;MACd,IAAI,CAACE,SAAS,EAAE;QACdC,YAAY,CAACgD,IAAI,CAACL,MAAM,CAAC;MAC3B,CAAC,MAAM;QACL,IAAI5C,SAAS,KAAKiD,IAAI,CAACL,MAAM,EAAE;UAC7B3C,YAAY,CAAC,IAAI,CAAC;QACpB,CAAC,MAAM;UACL,MAAMiD,OAAO,GAAG;YACdC,EAAE,EAAE,QAAQV,IAAI,CAACC,GAAG,CAAC,CAAC,EAAE;YACxBU,IAAI,EAAEpD,SAAS;YACfqD,EAAE,EAAEJ,IAAI,CAACL;UACX,CAAC;UACD,MAAMU,QAAQ,GAAGjE,OAAO,CAACkE,KAAK,GAAG,CAAC,GAAGlE,OAAO,CAACkE,KAAK,EAAEL,OAAO,CAAC,GAAG,CAACA,OAAO,CAAC;UACxE5D,UAAU,CAAC;YAAE,GAAGD,OAAO;YAAEkE,KAAK,EAAED;UAAS,CAAC,CAAC;UAC3CrD,YAAY,CAAC,IAAI,CAAC;QACpB;MACF;IACF;EACF,CAAC;;EAED;EACA,MAAMuD,eAAe,GAAGA,CAACC,MAAM,EAAE9C,CAAC,KAAK;IACrCA,CAAC,CAAC+C,eAAe,CAAC,CAAC;IACnB,IAAIC,MAAM,CAACC,OAAO,CAAC,aAAa,CAAC,EAAE;MACjC,MAAMN,QAAQ,GAAG,CAACjE,OAAO,CAACkE,KAAK,IAAI,EAAE,EAAEnB,MAAM,CAACyB,IAAI,IAAIA,IAAI,CAACV,EAAE,KAAKM,MAAM,CAAC;MACzEnE,UAAU,CAAC;QAAE,GAAGD,OAAO;QAAEkE,KAAK,EAAED;MAAS,CAAC,CAAC;IAC7C;EACF,CAAC;;EAED;EACA,MAAMQ,WAAW,GAAIlB,MAAM,IAAK;IAC9B,OAAOvD,OAAO,CAACqC,KAAK,CAACqC,IAAI,CAACC,CAAC,IAAIA,CAAC,CAACpB,MAAM,KAAKA,MAAM,CAAC;EACrD,CAAC;;EAED;EACA,MAAMqB,qBAAqB,GAAIhB,IAAI,IAAK;IACtC,IAAInD,UAAU,EAAE;IAChBK,gBAAgB,CAAC8C,IAAI,CAACL,MAAM,CAAC;IAC7BvC,cAAc,CAAC4C,IAAI,CAACJ,IAAI,CAAC;EAC3B,CAAC;;EAED;EACA,MAAMqB,gBAAgB,GAAItB,MAAM,IAAK;IACnC,MAAMnB,QAAQ,GAAGpC,OAAO,CAACqC,KAAK,CAACyC,GAAG,CAAClB,IAAI,IAAI;MACzC,IAAIA,IAAI,CAACL,MAAM,KAAKA,MAAM,EAAE;QAC1B,OAAO;UAAE,GAAGK,IAAI;UAAEJ,IAAI,EAAEzC;QAAY,CAAC;MACvC;MACA,OAAO6C,IAAI;IACb,CAAC,CAAC;IACF3D,UAAU,CAAC;MAAE,GAAGD,OAAO;MAAEqC,KAAK,EAAED;IAAS,CAAC,CAAC;IAC3CtB,gBAAgB,CAAC,IAAI,CAAC;IACtBE,cAAc,CAAC,EAAE,CAAC;EACpB,CAAC;;EAED;EACA,MAAM+D,aAAa,GAAGA,CAACzD,CAAC,EAAEiC,MAAM,KAAK;IACnC,IAAIjC,CAAC,CAAC0D,GAAG,KAAK,OAAO,IAAI,CAAC1D,CAAC,CAAC2D,QAAQ,EAAE;MACpC3D,CAAC,CAAC4D,cAAc,CAAC,CAAC;MAClBL,gBAAgB,CAACtB,MAAM,CAAC;IAC1B;EACF,CAAC;;EAED;EACA,MAAM4B,YAAY,GAAGA,CAAC3B,IAAI,EAAElC,CAAC,KAAK;IAChCA,CAAC,CAAC+C,eAAe,CAAC,CAAC;IACnBe,SAAS,CAACC,SAAS,CAACC,SAAS,CAAC9B,IAAI,CAAC,CAAC+B,IAAI,CAAC,MAAM;MAC7CC,KAAK,CAAC,+BAA+B,CAAC;IACxC,CAAC,CAAC,CAACC,KAAK,CAAEC,GAAG,IAAK;MAChBC,OAAO,CAACC,KAAK,CAAC,cAAc,EAAEF,GAAG,CAAC;IACpC,CAAC,CAAC;EACJ,CAAC;EAED,oBACE5F,OAAA;IAAA+F,QAAA,gBAEE/F,OAAA;MAAKgG,KAAK,EAAE;QAAEC,YAAY,EAAE;MAAG,CAAE;MAAAF,QAAA,gBAC/B/F,OAAA;QAAQkG,OAAO,EAAE9C,OAAQ;QAAA2C,QAAA,EAAC;MAAK;QAAAI,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAQ,CAAC,eACxCtG,OAAA;QACEkG,OAAO,EAAEA,CAAA,KAAM;UACbtF,aAAa,CAAC,CAACD,UAAU,CAAC;UAC1BG,YAAY,CAAC,IAAI,CAAC;QACpB,CAAE;QACFkF,KAAK,EAAE;UAAEO,UAAU,EAAE;QAAG,CAAE;QAAAR,QAAA,EAEzBpF,UAAU,GAAG,YAAY,GAAG;MAAU;QAAAwF,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACjC,CAAC,EACR3F,UAAU,iBACTX,OAAA;QAAMgG,KAAK,EAAE;UAAEO,UAAU,EAAE,EAAE;UAAEC,KAAK,EAAE;QAAO,CAAE;QAAAT,QAAA,EAC5ClF,SAAS,GAAG,UAAUA,SAAS,aAAa,GAAG;MAAe;QAAAsF,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAC3D,CACP;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACE,CAAC,eAGNtG,OAAA;MACEgG,KAAK,EAAE;QACLS,QAAQ,EAAE,UAAU;QACpBC,KAAK,EAAE,MAAM;QACbC,MAAM,EAAE,OAAO;QACfC,MAAM,EAAE,gBAAgB;QACxBC,QAAQ,EAAE;MACZ,CAAE;MACFC,WAAW,EAAE7E,eAAgB;MAC7B8E,SAAS,EAAE/D,aAAc;MAAA+C,QAAA,gBAGzB/F,OAAA;QACEgG,KAAK,EAAE;UACLS,QAAQ,EAAE,UAAU;UACpBzE,GAAG,EAAE,CAAC;UACNF,IAAI,EAAE,CAAC;UACP4E,KAAK,EAAE,MAAM;UACbC,MAAM,EAAE,MAAM;UACdK,aAAa,EAAE;QACjB,CAAE;QAAAjB,QAAA,EAED,CAAC7F,OAAO,CAACkE,KAAK,IAAI,EAAE,EAAEY,GAAG,CAAEN,IAAI,IAAK;UACnC,MAAMuC,QAAQ,GAAGtC,WAAW,CAACD,IAAI,CAACT,IAAI,CAAC;UACvC,MAAMiD,MAAM,GAAGvC,WAAW,CAACD,IAAI,CAACR,EAAE,CAAC;UACnC,IAAI,CAAC+C,QAAQ,IAAI,CAACC,MAAM,EAAE,OAAO,IAAI;UACrC,oBACElH,OAAA;YAEEmH,EAAE,EAAEF,QAAQ,CAACzE,CAAC,GAAG,EAAG;YACpB4E,EAAE,EAAEH,QAAQ,CAACxE,CAAC,GAAG,EAAG;YACpB4E,EAAE,EAAEH,MAAM,CAAC1E,CAAC,GAAG,EAAG;YAClB8E,EAAE,EAAEJ,MAAM,CAACzE,CAAC,GAAG,EAAG;YAClB8E,MAAM,EAAC,OAAO;YACdC,WAAW,EAAC,GAAG;YACfR,aAAa,EAAC,eAAe;YAC7Bd,OAAO,EAAG1E,CAAC,IAAK6C,eAAe,CAACK,IAAI,CAACV,EAAE,EAAExC,CAAC;UAAE,GARvCkD,IAAI,CAACV,EAAE;YAAAmC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OASb,CAAC;QAEN,CAAC;MAAC;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACC,CAAC,EAELpG,OAAO,CAACqC,KAAK,CAACyC,GAAG,CAAC,CAAClB,IAAI,EAAEX,GAAG,KAAK;QAChC,MAAMsE,cAAc,GAAGpH,QAAQ,CAACE,UAAU,IAAIF,QAAQ,CAACG,SAAS,KAAK2C,GAAG;QACxE,MAAMuE,KAAK,GAAGD,cAAc,GAAItG,YAAY,GAAG,GAAG,GAAG,GAAG,GAAI,GAAG;QAC/D,oBACEnB,OAAA;UAEEgG,KAAK,EAAE;YACLS,QAAQ,EAAE,UAAU;YACpB3E,IAAI,EAAEgC,IAAI,CAACtB,CAAC;YACZR,GAAG,EAAE8B,IAAI,CAACrB,CAAC;YACXkF,OAAO,EAAE,UAAU;YACnBC,UAAU,EAAEzE,GAAG,KAAK,CAAC,GAAG,SAAS,GAAG,SAAS;YAC7CyD,MAAM,EAAE,gBAAgB;YACxBiB,YAAY,EAAE,KAAK;YACnBC,MAAM,EAAEnH,UAAU,GAAG,SAAS,GAAG,MAAM;YACvCoH,UAAU,EAAE,MAAM;YAClBC,SAAS,EAAE,SAASN,KAAK,GAAG;YAC5BO,eAAe,EAAE;UACnB,CAAE;UACFC,WAAW,EAAG1G,CAAC,IAAKD,eAAe,CAACC,CAAC,EAAE2B,GAAG,CAAE;UAC5C+C,OAAO,EAAEA,CAAA,KAAMrC,eAAe,CAACC,IAAI,EAAEX,GAAG,CAAE;UAC1CgF,aAAa,EAAEA,CAAA,KAAMrD,qBAAqB,CAAChB,IAAI,CAAE;UAAAiC,QAAA,EAEhDhF,aAAa,KAAK+C,IAAI,CAACL,MAAM,gBAC5BzD,OAAA;YACEoI,KAAK,EAAEnH,WAAY;YACnBoH,QAAQ,EAAG7G,CAAC,IAAKN,cAAc,CAACM,CAAC,CAACG,MAAM,CAACyG,KAAK,CAAE;YAChDE,SAAS,EAAG9G,CAAC,IAAKyD,aAAa,CAACzD,CAAC,EAAEsC,IAAI,CAACL,MAAM,CAAE;YAChD8E,SAAS;YACTvC,KAAK,EAAE;cAAEU,KAAK,EAAE,OAAO;cAAEC,MAAM,EAAE;YAAQ;UAAE;YAAAR,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAC5C,CAAC,gBAEFtG,OAAA;YAAKgG,KAAK,EAAE;cAAES,QAAQ,EAAE;YAAW,CAAE;YAAAV,QAAA,gBACnC/F,OAAA;cAAKwI,uBAAuB,EAAE;gBAAEC,MAAM,EAAE5I,MAAM,CAAC6I,KAAK,CAAC5E,IAAI,CAACJ,IAAI;cAAE;YAAE;cAAAyC,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAE,CAAC,eAErEtG,OAAA;cACEkG,OAAO,EAAG1E,CAAC,IAAK6D,YAAY,CAACvB,IAAI,CAACJ,IAAI,EAAElC,CAAC,CAAE;cAC3CwE,KAAK,EAAE;gBACLS,QAAQ,EAAE,UAAU;gBACpB1D,MAAM,EAAE,CAAC,EAAE;gBACXD,KAAK,EAAE,CAAC,EAAE;gBACV4D,KAAK,EAAE,MAAM;gBACbC,MAAM,EAAE,MAAM;gBACdgC,eAAe,EAAE,OAAOrH,eAAe,GAAG;gBAC1CsH,cAAc,EAAE,OAAO;gBACvBC,OAAO,EAAE,GAAG;gBACZf,MAAM,EAAE;cACV;YAAE;cAAA3B,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACE,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACJ;QACN,GA7CIxC,IAAI,CAACL,MAAM;UAAA0C,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OA8Cb,CAAC;MAEV,CAAC,CAAC,eAEFtG,OAAA;QACE8I,GAAG,EAAEzH,QAAS;QACd2E,KAAK,EAAE;UACLS,QAAQ,EAAE,UAAU;UACpB1D,MAAM,EAAE,EAAE;UACVjB,IAAI,EAAE,KAAK;UACXkG,SAAS,EAAE,kBAAkB;UAC7BhB,aAAa,EAAE;QACjB,CAAE;QAAAjB,QAAA,eAEF/F,OAAA;UACE0G,KAAK,EAAEvF,YAAY,GAAG,EAAE,GAAG,EAAG;UAC9BwF,MAAM,EAAExF,YAAY,GAAG,EAAE,GAAG,EAAG;UAC/B4H,OAAO,EAAC,WAAW;UACnBC,IAAI,EAAC,KAAK;UAAAjD,QAAA,eAEV/F,OAAA;YAAMiJ,CAAC,EAAC;UAAuH;YAAA9C,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAC;QAAC;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAC9H;MAAC;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACH,CAAC,eAENtG,OAAA;QAAKgG,KAAK,EAAE;UAAES,QAAQ,EAAE,UAAU;UAAE1D,MAAM,EAAE,EAAE;UAAEjB,IAAI,EAAE;QAAG,CAAE;QAAAiE,QAAA,eACzD/F,OAAA,CAACF,WAAW;UAACoJ,SAAS,EAAEhJ,OAAO,CAAC8D;QAAG;UAAAmC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAE;MAAC;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACnC,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACH,CAAC;EAAA;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACH,CAAC;AAEV;AAAClG,EAAA,CA7SQH,aAAa;AAAAkJ,EAAA,GAAblJ,aAAa;AA+StB,eAAeA,aAAa;AAAC,IAAAkJ,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}